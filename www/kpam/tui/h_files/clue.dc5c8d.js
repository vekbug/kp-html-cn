this.Clue=this.Clue||{},this.Clue.Loader=function(){"use strict";var e={revison:"460c59e0",time:"2019-09-17 10:37:06",timestamp:1568687826966},n="vendor.19840f.js",t="activity.49a645.js",o="lottery.b0703d.js",a="lottery2.232712.js",r="phone.1699cb.js",c="phone.1699cb.js",i="consult.de0159.js",s="normalForm.850064.js",l="creativeForm.453f6c.js",d="commonCaptcha.8fb6d9.js",u="commonCreativeCaptcha.daec11.js",m="paySDK.ba7ea0.js",p="poll.e66127.js",v="clue.dc5c8d.js",h=("http:"===location.protocol?"http:":"https:")+"//s3.pstatp.com/bytecom/resource/clueapp/",f={clue:h+v,vendor:h+n,activity:h+t,lottery:h+o,lottery2:h+a,phone:h+r,phoneEvent:h+c,consultEvent:h+i,normalForm:h+s,creativeForm:h+l,commonCaptcha:h+d,commonCreativeCaptcha:h+u,paySDK:h+m,poll:h+p},y={vendor:{name:"Vendor",url:h+n,deps:[]},activity:{name:"Activity",url:h+t,deps:["vendor"]},lotteryOld:{name:"LotteryOld",url:h+"lottery.c43196.js",deps:[],oldName:"ClueLotteryApp"},lottery:{name:"Lottery",url:h+o,deps:["vendor"],oldName:"ClueLotteryApp"},lottery2:{name:"Lottery2",url:h+a,deps:["vendor"]},phone:{name:"Phone",url:h+r,deps:["vendor"],oldName:"phoneapp"},consult:{name:"Consult",url:h+i,deps:["vendor"],oldName:"consultapp"},normalForm:{name:"NormalForm",url:h+s,deps:["vendor"],oldName:"ClueNormalFormApp"},creativeForm:{name:"CreativeForm",url:h+l,deps:["vendor"],oldName:"ClueCreativeFormApp"},commonCaptcha:{name:"CommonCaptcha",url:h+d,deps:["vendor"],oldName:"commonCaptcha"},commonCreativeCaptcha:{name:"CommonCreativeCaptcha",url:h+u,deps:["vendor"],oldName:"commonCaptcha"},paySDK:{name:"PaySDK",url:h+m,deps:["vendor"],oldName:"paySDK"},poll:{name:"Poll",url:h+p,deps:["vendor"]}},w={};Object.keys(y).forEach(function(e){w[e]={loaded:!1,appendPromise:null,loadedPromise:null}});var C,g,_,b,N=(C={},{now:g=function(){return"function"==typeof performance.now?performance.now():Date.now()},mark:function(e){C[e]=g()},measure:function(e,n){return{startTime:C[e],endTime:C[n],duration:C[n]-C[e]}}}),k=function(){},P=new Promise(function(n,t){setTimeout(function(){n()},1e3);try{N.mark("get_assets_start");var o=new XMLHttpRequest;o.open("GET","//clue.toutiao.com/public/clue/get-assets",!0),o.send(),o.onreadystatechange=function(){if(4==o.readyState){if(200==o.status){var t=JSON.parse(o.responseText);t.version.timestamp>e.timestamp?(e.loaded=!0,e.revison=t.version.revison,e.time=t.version.time,Object.keys(y).forEach(function(e){t.assets[e]&&(y[e].url=h+t.assets[e])}),console.log("[CLUE]","update latest!",t)):console.log("[CLUE]","old assets!",t)}n(),N.mark("get_assets_end");var a=N.measure("get_assets_start","get_assets_end");k("send","timing",{category:"clue_loader",action:"get_assets_start",value:a.startTime}),k("send","timing",{category:"clue_loader",action:"get_assets_end",value:a.startTime+a.duration}),k("send","timing",{category:"clue_loader",action:"get_assets_duration",value:a.duration})}}}catch(e){console.warn("加载错误",e),n()}}),S=null;function j(e){var n=y[e],t=w[e];if(n&&t){if(t.loaded||window.Clue[n.name])return Promise.resolve();if(t.appendPromise)return t.appendPromise;var o;t.loadedPromise=new Promise(function(e){o=e});var a=P.then(function(){return Promise.all(n.deps.map(function(e){return j(e)}))}).then(function(){return new Promise(function(a,r){_||(_="load_".concat(e,"_start")),N.mark("load_".concat(e,"_start"));var c=document.createElement("script");c.onload=function(){n.loaded=!0,window.Clue[n.name]?n.oldName&&(window[n.oldName]=window.Clue[n.name]):n.oldName&&window[n.oldName]&&(window.Clue[n.name]=window[n.oldName]),o(),N.mark("load_".concat(e,"_end")),b="load_".concat(e,"_end");var t=N.measure("load_".concat(e,"_start"),"load_".concat(e,"_end"));k("send","timing",{category:"load_comp",action:"load_".concat(e,"_start"),value:t.startTime}),k("send","timing",{category:"load_comp",action:"load_".concat(e,"_end"),value:t.startTime+t.duration}),k("send","timing",{category:"load_comp",action:"load_".concat(e,"_duration"),value:t.duration}),-1!==S&&(S>0&&clearTimeout(S),S=setTimeout(function(){if(_&&b){S=-1;var e=N.measure(_,b);k("send","timing",{category:"load_comp",action:"load_all_start",value:e.startTime}),k("send","timing",{category:"load_comp",action:"load_all_end",value:e.startTime+e.duration}),k("send","timing",{category:"load_comp",action:"load_all_duration",value:e.duration})}},5e3))},c.onerror=function(e){t.loadPromise=null,r(e)},c.src=n.url,c.async=!1,document.body.appendChild(c),a()})},function(e){return t.appendPromise=null,Promise.reject(e)});return t.appendPromise=a,a}}function T(e){window.clueErrorLog||(window.clueErrorLog=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return console.error(n)}),j(e);var n=w[e];if(n)return n.loadedPromise}var I=function(){var e=k.n?k.n.i:k;e.shared&&e.shared.transport&&"function"==typeof e.shared.transport.postEvent&&(I=e.shared.transport.postEvent.bind(e.shared.transport)).apply(null,arguments)};var E,F,A,L,D,q,x,B=function(e,n){if(e)switch(e){case"normalForm":T("normalForm").then(function(){n()});break;default:console.warn("nothing to load, type=",e)}},K=function(e,n,t){if(e)switch(e){case"lottery":T("lotteryOld").then(function(){new ClueLotteryApp({compId:n.compId||0,clueAccountId:n.clueAccountId||0,advId:n.advId||0,container:n.container||document.querySelector("body"),extraData:n.extraData})});break;case"phoneEvent":T("phone").then(function(){window.Clue.Phone.createPhoneEvent({content:{type:n.type,normalPhoneNumber:n.normalPhoneNumber,smartPhoneContent:{instanceId:n.instanceId,phoneNumber:n.phoneNumber}},advToken:n.advToken,clueAccountId:n.clueAccountId||0},n.container)});break;case"consultEvent":T("consult").then(function(){window.Clue.Consult.createConsultEvent({consultType:n.consultType,link:n.link,consultId:n.consultId},n.container)});break;case"phone":T("phone").then(function(){window.Clue.Phone.createPhone({content:{type:n.type,normalPhoneNumber:n.normalPhoneNumber,smartPhoneContent:{instanceId:n.instanceId,phoneNumber:n.phoneNumber}},appearance:{buttonBgColor:n.buttonBgColor,fontColor:n.fontColor,btnText:n.btnText},advToken:n.advToken,clueAccountId:n.clueAccountId||0},n.container)});break;case"creativeForm":T("creativeForm").then(function(){});break;case"normalForm":T("normalForm").then(function(){window.Clue.NormalForm().createById({container:n.container,data:n.data,externalSetting:n.externalSetting})});break;case"commonCaptcha":T("commonCaptcha").then(function(){});break;case"commonCreativeCaptcha":T("commonCreativeCaptcha").then(function(){});break;case"paySDK":T("paySDK").then(function(){t()});break;case"getClueLoader":return B;case"getClueUrl":return f}};window.createClueComp||(window.createClueComp=K);try{x=function(e){var n,t=window.location.href.match(/(tetris\/page\/creative\/\d*?)|(tetris\/page\/\d*?)|(tetris\/store\/\d*?)/i);return t?t[1]?n="creative_form":t[2]?n="tetris_landing_page":t[3]&&(n="tetris_store"):n="other_page",n}(),function(e){var n=e.match(/aweme|newsarticle|videoarticle|live_stream|MicroMessenger|UCBrowser/i);if(n&&n[0])return n[0];var t=e.match(/chrome|safari/i);t&&t[0]&&t[0]}(navigator.userAgent),window.Slardar&&window.Slardar.createInstance||(E=window,F=document,A="script",L="Slardar",E.SlardarMonitorObject=L,E[L]||(E[L]=function(){(E[L].q=E[L].q||[]).push(arguments)},E[L].createInstance=function(){var e={q:[],i:function(){(e.q=e.q||[]).push(arguments)}};(E[L].i=E[L].i||[]).push(e);var n=function(){e.i.apply(null,arguments)};return n.n=e,n}),E[L].l=1*new Date,D=F.createElement(A),q=F.getElementsByTagName(A)[0],D.async=1,D.src="https://i.snssdk.com/slardar/sdk.js?bid=clue_nidapp",q.parentNode.insertBefore(D,q)),(k=window.Slardar.createInstance())("config",{bid:"clue_nidapp",pid:x,ignoreAjax:[],ajaxWhitelistUrls:["clue.toutiao.com","clue.oceanengine.com","chengzijianzhan.com"],ignoreStatic:[],hookFetch:!0,enableSizeStats:!0}),window.Clue.Slardar=k,function(){var n,t,o,a,r,c;window.SentryLoad||(n=window,t=document,o="script",n[a="SentryLoad"]=function(e){(n[a].q=n[a].q||[]).push(e)},r=t.createElement(o),c=t.getElementsByTagName(o)[0],r.async=1,r.setAttribute("crossorigin","anonymous"),r.src="https://sf1-ttcdn-tos.pstatp.com/obj/ttfe/sentry/5.6.1/bundle.min.js",r.onload=function(e){e=n[a].q,n[a]=function(e){e.apply(null)},e&&e.forEach(function(e){e.apply(null)})},c.parentNode.insertBefore(r,c)),window.SentryLoad(function(){var n=window.Sentry,t=n.defaultIntegrations.concat();t.splice(4,1),t.splice(2,1);var o=new n.BrowserClient({defaultIntegrations:t,dsn:"https://key@i.snssdk.com/log/sentry/v2/slardar",beforeSend:function(e){return I({ev_type:"jserr",sentry:e}),null},release:e.revison}),a=new n.Hub(o);window.Clue.Sentry=a})}(),k("send","timing",{category:"clue_loader",action:"clue_loaded",value:N.now()})}catch(e){console.warn(e)}return{version:e,load:T,createClueComp:K}}();
