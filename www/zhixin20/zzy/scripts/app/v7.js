"use strict";define(["util","appinfo","track"],function(c,e,a){var s=new URLSearchParams(location.search),o=c.isWechat(),t=s.get("pkg")||"7",n=e.package_infos[t],r=(s.get("chid")||"").toLowerCase().replace(/s.*-/g,"");if(r){var i=void 0,p=void 0,l=void 0,u=null,h={zzy:r};return console.log("Channel ID: "+r),{init:function(o){if(i=$(".masker"),p=$(".app-download"),l=$("#copyright"),o){var t="";o.split("\n").map(function(o){t=t+"<p>"+o+"</p>"}),l.html(t)}e.fetch(r),a.required()&&(h=a.params(r),a.post(h)),$.ajax({url:"https://api.818tu.com/v1/jsonp/bidding?articles=2&latest_entry=0&id="+s.get("id")+"&title="+encodeURIComponent(s.get("title")||""),dataType:"jsonp",success:function(o){if(o.error)alert(o.error);else{u=o.data.novel;var t=o.data.articles;document.title=u.title+"小说",$(".title").html(u.title),$(".avatar").css("background-image","url(//qcdn-legacy.zhangzhongyun.com/bookcovershaow1.png)"),$(".thumb").css("background-image","url('"+u.avatar+"')"),$(".footer").css("background-image","url(//qcdn-legacy.zhangzhongyun.com/5a2887bfadce41f79daa7807ecaf4011.jpg)");for(var e=$("#content"),a="",n=0;n<t.length;n++){var r=t[n],i=r.content.split("\n");a+='<h3 class="title">'+r.title+"</h3>";for(var l=0;l<i.length;l++){var d=i[l].replace(/^[\s　]+/g,"");d&&(a+="<p>"+d+"</p>")}}a+='<p style="color:red">亲，因篇幅限制，后续精彩内容请点击下图继续阅读</p>',e.html(a),h.pnid=s.get("id"),h.pnext_idx=3,u.alias_id&&(h.palias_id=u.alias_id),p.each(function(){new ClipboardJS(this,{text:function(){return c.format(h)}})})}},error:function(){alert("发生错误")}}),p.tap(d),i.tap(function(){return i.hide()}),$("#wrapper").on("scroll",function(){90<$("#wrapper").scrollTop()?$(".footer").addClass("scroll"):$(".footer").removeClass("scroll")})}}}function d(){if(window._agl&&window._agl.push(["track",["success",{t:3}]]),!$.os.android)return $.os.ios?(_hmt.push(["_trackEvent","download","ios",u.title]),void(window.top.location.href=n.url)):void alert("只支持 Android 和 iOS 设备！");o?i.show():(_hmt.push(["_trackEvent","download","android",u.title]),e.fetch(r,function(o){var t,e;"iframe"===(window.__android_download_mode||"iframe")?(console.log("Loading iframe: "+o.download_url),t=o.download_url,e=document.createElement("iframe"),$(e).css({width:0,height:0,position:"absolute",left:"-5000px"}),e.onload=function(){document.body.removeChild(e)},e.src=t,document.body.appendChild(e)):location.href=o.download_url}))}alert("缺少 chid")});