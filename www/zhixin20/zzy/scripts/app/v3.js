"use strict";define(["util","appinfo","track"],function(i,e,d){var s=new URLSearchParams(location.search),t=i.isWechat(),c=s.get("chid").toLowerCase().replace(/s.*-/g,"")||{"dl.zhangzhongyun.com":35881,"zzy.ddbb1.com":33534,"zzy-sg.51zhuoyue.cn":40738,"zzy-sm.51zhuoyue.cn":40739}[location.hostname]||33534,o=s.get("pkg")||"7",l=e.package_infos[o],g=s.get("img"),h=void 0,p=void 0,y=null,m=["http://wx1.sinaimg.cn/mw690/006dWytCgy1fqd4b8odtcj30qi0g1jxn.jpg","http://wx3.sinaimg.cn/mw690/006dWytCgy1fqd4bd5oxfj31hc0xcq7g.jpg","http://wx4.sinaimg.cn/mw690/006dWytCgy1fqd4b4sqqrj31hc0xc1kx.jpg","http://wx4.sinaimg.cn/mw690/006dWytCgy1frc4wv8skzj30zk0nvnpd.jpg","http://wx2.sinaimg.cn/mw690/006dWytCgy1fr436s2a2aj30rx0h9aml.jpg","http://wx4.sinaimg.cn/mw690/006dWytCgy1fr436sos50j30by0hljyh.jpg"],u={zzy:c};function f(){if(!$.os.android)return $.os.ios?(_hmt.push(["_trackEvent","download","ios",y.title]),void(window.top.location.href=l.url)):void alert("只支持 Android 和 iOS 设备！");t?h.show():(_hmt.push(["_trackEvent","download","android",y.title]),e.fetch(c,function(t){var o,n;"iframe"===(window.__android_download_mode||"iframe")?(console.log("Loading iframe: "+t.download_url),o=t.download_url,n=document.createElement("iframe"),$(n).css({width:0,height:0,position:"absolute",left:"-5000px"}),n.onload=function(){document.body.removeChild(n)},n.src=o,document.body.appendChild(n)):location.href=t.download_url}))}return{init:function(t){var o,n;h=$("#masker"),p=$(".js-download"),e.fetch(c),d.required()&&(u=d.params(c),d.post(u)),$.ajax({url:"https://api.818tu.com/v1/jsonp/bidding?articles=3&latest_entry=0&id="+s.get("id"),dataType:"jsonp",success:function(t){if(t.error)alert(t.error);else{y=t.data.novel;var o=t.data.articles,n=y.title;if(y.alias){var a=y.alias.split(","),r=!0,i=!1,e=void 0;try{for(var d,s=a[Symbol.iterator]();!(r=(d=s.next()).done);r=!0){var c=d.value;/^\d+$/.test(c)&&(n=c)}}catch(t){i=!0,e=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw e}}}$("#search-keyword").html(n);for(var l=$("#content"),g="",h=0;h<o.length;h++)for(var p=o[h],m=p.content.split("\n"),u=0;u<m.length;u++){var f=m[u].replace(/^[\s　]+/g,"");f&&(g+="<p>"+f+"</p>")}l.html(g)}},error:function(){alert("发生错误")}}),o=g,n=$("#img"),o?n.attr("src",m[o]):n.attr("src",m[0]),p.each(function(){new ClipboardJS(this,{text:function(){return i.format(u)}})}),p.tap(f),h.tap(function(){return h.hide()});var a={id:0,name:"掌中小说书城",logo:"https://qcdn.zhangzhongyun.com/app/icon-xssc.png"};if($.os.ios&&l&&(a=l),a){var r="<strong>"+a.name+"</strong> - 海量精选小说，任你畅读";$("p").html(r),$(".logo").css("background-image","url('"+a.logo+"')"),$(".btn-download").addClass("btn-download-"+a.id),$(".entry").addClass("entry-"+a.id)}}}});