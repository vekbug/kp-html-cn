"use strict";define(["util","appinfo","track"],function(c,o,a){var s=new URLSearchParams(location.search),e=c.isWechat(),t=s.get("pkg")||"7",n=o.package_infos[t],r=(s.get("chid")||"").toLowerCase().replace(/s.*-/g,"");if(r){var i=void 0,u=void 0,p=null,h={zzy:r};return console.log("Channel ID: "+r),{init:function(){i=$(".masker"),u=$(".app-download"),o.fetch(r),a.required()&&(h=a.params(r),a.post(h)),$.ajax({url:"https://api.818tu.com/v1/jsonp/bidding?articles=2&latest_entry=0&id="+s.get("id")+"&title="+encodeURIComponent(s.get("title")||""),dataType:"jsonp",success:function(o){if(o.error)alert(o.error);else{p=o.data.novel;var a=o.data.articles;$(".title").html(p.title),$(".avatar").css("background-image","url(//qcdn-legacy.zhangzhongyun.com/bookcovershaow1.png)"),$(".thumb").css("background-image","url('"+p.avatar+"')"),$(".footer").css("background-image","url(//qcdn-legacy.zhangzhongyun.com/5a2887bfadce41f79daa7807ecaf4011.jpg)");for(var e=$("#content"),t="",n=0;n<a.length;n++){var r=a[n],i=r.content.split("\n");t+='<h3 class="title">'+r.title+"</h3>";for(var l=0;l<i.length;l++){var d=i[l].replace(/^[\s　]+/g,"");d&&(t+="<p>"+d+"</p>")}}t+='<p style="color:red">亲，因篇幅限制，后续精彩内容请点击下图继续阅读</p>',e.html(t),h.pnid=s.get("id"),h.pnext_idx=1,p.alias_id&&(h.palias_id=p.alias_id),u.each(function(){new ClipboardJS(this,{text:function(){return c.format(h)}})})}},error:function(){alert("发生错误")}}),u.tap(l),i.tap(function(){return i.hide()}),$("#wrapper").on("scroll",function(){90<$("#wrapper").scrollTop()?$(".footer").addClass("scroll"):$(".footer").removeClass("scroll")})}}}function l(){if(window._agl&&window._agl.push(["track",["success",{t:3}]]),!$.os.android)return $.os.ios?(_hmt.push(["_trackEvent","download","ios",p.title]),void(window.top.location.href=n.url)):void alert("只支持 Android 和 iOS 设备！");e?i.show():(_hmt.push(["_trackEvent","download","android",p.title]),o.fetch(r,function(o){var a,e;"iframe"===(window.__android_download_mode||"iframe")?(console.log("Loading iframe: "+o.download_url),a=o.download_url,e=document.createElement("iframe"),$(e).css({width:0,height:0,position:"absolute",left:"-5000px"}),e.onload=function(){document.body.removeChild(e)},e.src=a,document.body.appendChild(e)):location.href=o.download_url}))}alert("缺少 chid")});